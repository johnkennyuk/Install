#!/bin/bash
############# https://github.com/plexguide/PlexGuide.com/graphs/contributors ###
pgupdate_ending () {
echo ""
cat << "EOF"
[38;5;33m‚îå[0m[38;5;33m‚îÄ[0m[38;5;33m‚îÄ[0m[38;5;33m‚îÄ[0m[38;5;33m‚îÄ[0m[38;5;33m‚îÄ[0m[38;5;33m‚îÄ[0m[38;5;33m‚îÄ[0m[38;5;33m‚îÄ[0m[38;5;39m‚îÄ[0m[38;5;39m‚îÄ[0m[38;5;39m‚îÄ[0m[38;5;39m‚îÄ[0m[38;5;39m‚îÄ[0m[38;5;39m‚îÄ[0m[38;5;39m‚îÄ[0m[38;5;39m‚îÄ[0m[38;5;39m‚îÄ[0m[38;5;38m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;43m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îê[0m
[38;5;33m‚îÇ[0m[38;5;33m‚ñë[0m[38;5;33m‚ñë[0m[38;5;33m‚ñë[0m[38;5;33m‚ñë[0m[38;5;33m‚ñë[0m[38;5;39m‚ñë[0m[38;5;39m‚ñë[0m[38;5;39m‚ñë[0m[38;5;39m‚ñë[0m[38;5;39m‚ñë[0m[38;5;39m‚ñë[0m[38;5;39m‚ñë[0m[38;5;39m‚ñë[0m[38;5;39m‚ñë[0m[38;5;38m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;43m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;48m‚ñë[0m[38;5;48m‚îÇ[0m
[38;5;33m‚îÇ[0m[38;5;33m‚ñë[0m[38;5;33m‚ñà[0m[38;5;39m‚ñÄ[0m[38;5;39m‚ñà[0m[38;5;39m‚ñë[0m[38;5;39m‚ñà[0m[38;5;39m‚ñë[0m[38;5;39m‚ñë[0m[38;5;39m‚ñë[0m[38;5;39m‚ñà[0m[38;5;39m‚ñÄ[0m[38;5;38m‚ñÄ[0m[38;5;44m‚ñë[0m[38;5;44m‚ñà[0m[38;5;44m‚ñë[0m[38;5;44m‚ñà[0m[38;5;44m‚ñë[0m[38;5;44m‚ñà[0m[38;5;44m‚ñÄ[0m[38;5;44m‚ñÄ[0m[38;5;44m‚ñë[0m[38;5;44m‚ñà[0m[38;5;44m‚ñë[0m[38;5;43m‚ñà[0m[38;5;49m‚ñë[0m[38;5;49m‚ñÄ[0m[38;5;49m‚ñà[0m[38;5;49m‚ñÄ[0m[38;5;49m‚ñë[0m[38;5;49m‚ñà[0m[38;5;49m‚ñÄ[0m[38;5;49m‚ñÑ[0m[38;5;49m‚ñë[0m[38;5;48m‚ñà[0m[38;5;48m‚ñÄ[0m[38;5;48m‚ñÄ[0m[38;5;48m‚ñë[0m[38;5;48m‚îÇ[0m
[38;5;39m‚îÇ[0m[38;5;39m‚ñë[0m[38;5;39m‚ñà[0m[38;5;39m‚ñÄ[0m[38;5;39m‚ñÄ[0m[38;5;39m‚ñë[0m[38;5;39m‚ñà[0m[38;5;39m‚ñë[0m[38;5;39m‚ñë[0m[38;5;38m‚ñë[0m[38;5;44m‚ñà[0m[38;5;44m‚ñÄ[0m[38;5;44m‚ñÄ[0m[38;5;44m‚ñë[0m[38;5;44m‚ñÑ[0m[38;5;44m‚ñÄ[0m[38;5;44m‚ñÑ[0m[38;5;44m‚ñë[0m[38;5;44m‚ñà[0m[38;5;44m‚ñë[0m[38;5;44m‚ñà[0m[38;5;43m‚ñë[0m[38;5;49m‚ñà[0m[38;5;49m‚ñë[0m[38;5;49m‚ñà[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñà[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñà[0m[38;5;48m‚ñë[0m[38;5;48m‚ñà[0m[38;5;48m‚ñë[0m[38;5;48m‚ñà[0m[38;5;48m‚ñÄ[0m[38;5;48m‚ñÄ[0m[38;5;48m‚ñë[0m[38;5;48m‚îÇ[0m
[38;5;39m‚îÇ[0m[38;5;39m‚ñë[0m[38;5;39m‚ñÄ[0m[38;5;39m‚ñë[0m[38;5;39m‚ñë[0m[38;5;39m‚ñë[0m[38;5;38m‚ñÄ[0m[38;5;44m‚ñÄ[0m[38;5;44m‚ñÄ[0m[38;5;44m‚ñë[0m[38;5;44m‚ñÄ[0m[38;5;44m‚ñÄ[0m[38;5;44m‚ñÄ[0m[38;5;44m‚ñë[0m[38;5;44m‚ñÄ[0m[38;5;44m‚ñë[0m[38;5;44m‚ñÄ[0m[38;5;44m‚ñë[0m[38;5;43m‚ñÄ[0m[38;5;49m‚ñÄ[0m[38;5;49m‚ñÄ[0m[38;5;49m‚ñë[0m[38;5;49m‚ñÄ[0m[38;5;49m‚ñÄ[0m[38;5;49m‚ñÄ[0m[38;5;49m‚ñë[0m[38;5;49m‚ñÄ[0m[38;5;49m‚ñÄ[0m[38;5;48m‚ñÄ[0m[38;5;48m‚ñë[0m[38;5;48m‚ñÄ[0m[38;5;48m‚ñÄ[0m[38;5;48m‚ñë[0m[38;5;48m‚ñë[0m[38;5;48m‚ñÄ[0m[38;5;48m‚ñÄ[0m[38;5;48m‚ñÄ[0m[38;5;84m‚ñë[0m[38;5;83m‚îÇ[0m
[38;5;39m‚îÇ[0m[38;5;39m‚ñë[0m[38;5;39m‚ñë[0m[38;5;38m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;44m‚ñë[0m[38;5;43m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;49m‚ñë[0m[38;5;48m‚ñë[0m[38;5;48m‚ñë[0m[38;5;48m‚ñë[0m[38;5;48m‚ñë[0m[38;5;48m‚ñë[0m[38;5;48m‚ñë[0m[38;5;48m‚ñë[0m[38;5;48m‚ñë[0m[38;5;48m‚ñë[0m[38;5;84m‚ñë[0m[38;5;83m‚ñë[0m[38;5;83m‚ñë[0m[38;5;83m‚ñë[0m[38;5;83m‚îÇ[0m
[38;5;38m‚îî[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;44m‚îÄ[0m[38;5;43m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;49m‚îÄ[0m[38;5;48m‚îÄ[0m[38;5;48m‚îÄ[0m[38;5;48m‚îÄ[0m[38;5;48m‚îÄ[0m[38;5;48m‚îÄ[0m[38;5;48m‚îÄ[0m[38;5;48m‚îÄ[0m[38;5;48m‚îÄ[0m[38;5;48m‚îÄ[0m[38;5;84m‚îÄ[0m[38;5;83m‚îÄ[0m[38;5;83m‚îÄ[0m[38;5;83m‚îÄ[0m[38;5;83m‚îÄ[0m[38;5;83m‚îÄ[0m[38;5;83m‚îÄ[0m[38;5;83m‚îò[0m
EOF

cat << "EOF"
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ        EXITING PG Version X         ‚îÇ
‚îÇ ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚îÇ
‚îÇ Star PG:      plexguide.com/github  ‚îÇ
‚îÇ Donate:       plexguide.com/donate  ‚îÇ
‚îÇ ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚îÇ
‚îÇ Restart PlexGuide:      plexguide   ‚îÇ
‚îÇ Update  PlexGuide:      pgupdate    ‚îÇ
‚îÇ ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî ‚îÇ
‚îÇ An Original Admin9705 Project       ‚îÇ
‚îÇ                                     ‚îÇ
‚îÇ Dedicated to:                       ‚îÇ
‚îÇ Deiteq, YasQueen84 & JasMarie       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
EOF
exit
}

pgupdate_start () {
rm -rf /pg/tmp/install/update
git clone -b v1 --single-branch https://github.com/plexguide/install.git /pg/tmp/install/update

cp -f /pg/tmp/install/update/pgupdate /bin/
chmod 0755 /bin/pgupdate
chown 1000:1000 /bin/pgupdate

fmt -w 79 /pg/tmp/install/update/versions > /pg/tmp/install/update/wrap
versions=$(cat /pg/tmp/install/update/wrap)

# FUNCTIONS ####################################################################
common_message() {
tee <<-EOF

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
$1
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
$2
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
EOF
}

common_header() {
tee <<-EOF

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
$1
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
EOF
}

common_number() {
  read -p '‚ÜòÔ∏è  Type Selection | Press [ENTER]: ' typed < /dev/tty
}

common_confirm() {
  read -p 'Confirm Information | Press [ENTER] ' typed </dev/tty
}

common_fcreate_silent() {
    mkdir -p "$1"
    chown 1000:1000 "$1"
    chmod 0775 "$1"
}
# EXECUTION ####################################################################
common_message "üöÄ PG Update Interface - üíæ Type a Version to Update" "$versions

[Z] Exit Interface"
common_number

case $typed in
    Z ) pgupdate_ending && exit ;;
    z ) pgupdate_ending && exit ;;
    * ) a=a ;;
esac

install_version=$typed
common_header "üíæ Install PG Version - $install_version? [y/n]"
common_number

case $typed in
    N ) pgupdate_ending && exit ;;
    n ) pgupdate_ending && exit ;;
    y ) a=a ;;
    Y ) a=a ;;
    * ) pgupdate_start && exit ;;
esac

if [[ "$install_version" == "alpha" ]]; then
common_fcreate_silent /pg/var/version && echo "Alpha" > /pg/var/version/pg.build
sudo wget -nc https://raw.githubusercontent.com/plexguide/PlexGuide.com/alpha/mods/install/main.sh -O- | sudo bash && exit
fi

catch_num=$(cat /pg/tmp/install/update/versions | grep -c -w "\<$install_version\>")

if [[ "$catch_num" == "1" ]]; then
rm -rf /tmp/PlexGuide*

sudo wget "https://github.com/plexguide/PlexGuide.com/archive/${install_version}.zip" -P /tmp
if [[ ! -e "/usr/bin/unzip" ]]; then apt-get install unzip -y; fi
unzip "/tmp/${install_version}.zip" -d /tmp
bash "/tmp/PlexGuide.com-${install_version}/mods/install/main.sh"
common_fcreate_silent /pg/var/version && echo "${install_version}" > /pg/var/version/pg.build
exit && exit
else
common_header "‚õîÔ∏è WARNING! DOES NOT EXIST - $install_version! Try Again!"
common_confirm
pgupdate_start && exit
fi

}

pgupdate_start
